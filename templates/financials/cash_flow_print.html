<!DOCTYPE html>
<html lang="{{ get_locale() or 'ar' }}" dir="{{ 'rtl' if (get_locale() or 'ar') == 'ar' else 'ltr' }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ _('Cash Flow') }} — {{ company_name or 'Company' }}</title>
  {% include 'partials/accounting_print_styles.html' %}
</head>
<body>

  <div class="acct-print-header">
    <div class="acct-print-company">
      {% if show_logo and logo_url %}
        <img src="{{ logo_url }}" alt="" class="acct-print-logo">
      {% endif %}
      <h1>{{ company_name or 'Company' }}</h1>
      <small>VAT: {{ tax_number or '-' }}{% if address %} | {{ address }}{% endif %}</small>
    </div>
    <div class="acct-print-report-title">
      <h2>{{ _('Cash Flow') }}</h2>
      <small>التدفق النقدي</small>
    </div>
  </div>

  <div class="acct-print-meta">
    <span>{{ _('Printed') }}: {{ generated_at or '' }}</span>
    <span>{{ _('Range') }}: {{ data.start_date.isoformat() if data.start_date and hasattr(data.start_date, 'isoformat') else data.start_date }} → {{ data.end_date.isoformat() if data.end_date and hasattr(data.end_date, 'isoformat') else data.end_date }}</span>
    <span>{{ _('Inflow') }}: <span class="acct-mono">{{ '%.2f'|format(data.inflow or 0) }}</span> | {{ _('Outflow') }}: <span class="acct-mono">{{ '%.2f'|format(data.outflow or 0) }}</span> | {{ _('Net') }}: <span class="acct-mono">{{ '%.2f'|format(data.net or 0) }}</span></span>
  </div>

  <table class="acct-print-table">
    <thead>
      <tr>
        <th>{{ _('Account') }}</th>
        <th>{{ _('Date') }}</th>
        <th>{{ _('Debit') }} ({{ _('Inflow') }})</th>
        <th>{{ _('Credit') }} ({{ _('Outflow') }})</th>
        <th>{{ _('Balance') }}</th>
      </tr>
    </thead>
    <tbody>
      {% for r in (data.rows or []) %}
      <tr>
        <td class="account">{{ r.code }} – {{ r.name }}</td>
        <td>{{ r.date.isoformat() if r.date and hasattr(r.date, 'isoformat') else r.date }}</td>
        <td class="mono">{{ '%.2f'|format(r.debit or 0) }}</td>
        <td class="mono">{{ '%.2f'|format(r.credit or 0) }}</td>
        <td class="mono">{{ '%.2f'|format(r.running_balance | default(0)) }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="acct-print-footer">
    {{ _('Generated by Accounting System') }}
  </div>

  <div class="acct-print-signature">
    <div class="sig-block"><span>{{ _('Accountant') }}</span><div class="sig-line"></div></div>
    <div class="sig-block"><span>{{ _('Stamp') }}</span><div class="sig-line"></div></div>
  </div>
  <div class="acct-print-pageno acct-print-footer">{{ _('Page') }} 1</div>

  <script>
    (function(){ setTimeout(function(){ try { window.print(); } catch(e) {} }, 300); })();
  </script>
</body>
</html>

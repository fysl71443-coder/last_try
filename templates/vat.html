{% extends 'base.html' %}
{% block title %}{{ _('VAT Return') }}{% endblock %}
{% block content %}
<div class="container py-4 ops-layout hub-wrap">
  <div class="ops-header-bar">
    <span class="ops-icon"><i class="fa-solid fa-percent"></i></span>
    <div>
      <h1 class="ops-title mb-0">{{ _('VAT Return') }}</h1>
      <span class="ops-subtitle">{{ _('Period summary and VAT totals') }}</span>
    </div>
    <div class="ops-actions">
      <a href="{{ url_for('main.dashboard') }}" class="btn btn-sm"><i class="fa-solid fa-house me-1"></i>{{ _('Dashboard') }}</a>
      <a href="{{ url_for('vat.vat_dashboard') }}" class="btn btn-sm"><i class="fa-solid fa-chart-pie me-1"></i>{{ _('VAT Dashboard') }}</a>
    </div>
  </div>

  <div class="ops-form-card mt-0">
    <div class="ops-form-head">{{ _('Filters') }}</div>
    <div class="ops-form-body">
      <form method="GET" class="row g-3 align-items-end">
        <div class="col-md-3">
          <label class="form-label">{{ _('Year') }}</label>
          <select name="year" class="form-select">
            {% for y in range(2020, 2036) %}
            <option value="{{ y }}" {{ 'selected' if y==year }}>{{ y }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label">{{ _('Quarter') }}</label>
          <select name="quarter" class="form-select">
            <option value="Q1" {{ 'selected' if quarter=='Q1' }}>Q1 (Jan–Mar)</option>
            <option value="Q2" {{ 'selected' if quarter=='Q2' }}>Q2 (Apr–Jun)</option>
            <option value="Q3" {{ 'selected' if quarter=='Q3' }}>Q3 (Jul–Sep)</option>
            <option value="Q4" {{ 'selected' if quarter=='Q4' }}>Q4 (Oct–Dec)</option>
          </select>
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-primary w-100"><i class="fa-solid fa-eye me-1"></i>{{ _('Show') }}</button>
        </div>
      </form>
    </div>
  </div>

  <div class="ops-form-card">
    <div class="ops-form-head">{{ _('Period') }}: {{ start_date }} → {{ end_date }}</div>
    <div class="ops-form-body">
      <div class="kpi-row">
        <div class="kpi-card kpi-card--blue">
          <div class="kpi-value">{{ '%.2f'|format(sales_before) }}</div>
          <div class="kpi-label">{{ _('Sales (Before VAT)') }}</div>
          <div class="kpi-sub">{{ _('Output VAT') }}: {{ '%.2f'|format(output_vat) }}</div>
        </div>
        <div class="kpi-card kpi-card--blue">
          <div class="kpi-value">{{ '%.2f'|format(purchases_before) }}</div>
          <div class="kpi-label">{{ _('Purchases (Before VAT)') }}</div>
          <div class="kpi-sub">{{ _('Input VAT') }}: {{ '%.2f'|format(input_vat) }}</div>
        </div>
        <div class="kpi-card kpi-card--blue">
          <div class="kpi-value">{{ '%.2f'|format(expenses_before) }}</div>
          <div class="kpi-label">{{ _('Expenses (Before VAT)') }}</div>
        </div>
      </div>
    </div>
  </div>

  <div class="ops-form-card">
    <div class="ops-form-head">{{ _('VAT Summary') }}</div>
    <div class="ops-form-body">
      <div class="kpi-row">
        <div class="kpi-card kpi-card--blue"><div class="kpi-value">{{ '%.2f'|format(output_vat) }}</div><div class="kpi-label">{{ _('Output VAT') }}</div></div>
        <div class="kpi-card kpi-card--green"><div class="kpi-value">{{ '%.2f'|format(input_vat) }}</div><div class="kpi-label">{{ _('Input VAT') }}</div></div>
        <div class="kpi-card kpi-card--orange"><div class="kpi-value">{{ '%.2f'|format(net_vat) }}</div><div class="kpi-label">{{ _('Net VAT') }}</div></div>
      </div>
      <small class="text-muted d-block mt-2">{{ _('Zero-rated and exempt amounts require item-level tagging for precise reporting.') }}</small>
      <div class="d-flex justify-content-end gap-2 mt-3">
        <a href="#" class="btn btn-outline-primary btn-sm" onclick="window.print();return false;"><i class="fa-solid fa-print me-1"></i>{{ _('Print') }}</a>
        <a href="{{ url_for('reports.reports') }}" class="btn btn-outline-secondary btn-sm"><i class="fa-solid fa-chart-line me-1"></i>{{ _('Reports') }}</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}

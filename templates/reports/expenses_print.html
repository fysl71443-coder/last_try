<!DOCTYPE html>
<html lang="{{ get_locale() or 'ar' }}" dir="{{ 'rtl' if (get_locale() or 'ar') == 'ar' else 'ltr' }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ _('Expenses Report') }} — {{ company_name or 'Company' }}</title>
  {% include 'partials/accounting_print_styles.html' %}
</head>
<body>

  <div class="acct-print-toolbar no-print">
    <button type="button" class="acct-print-btn acct-print-btn-primary" onclick="window.print()">{{ _('Print') }}</button>
    <button type="button" class="acct-print-btn acct-print-btn-secondary" onclick="history.back()">{{ _('Back') }}</button>
  </div>

  <div class="acct-print-header">
    <div class="acct-print-company">
      {% if show_logo and logo_url %}
        <img src="{{ logo_url }}" alt="" class="acct-print-logo">
      {% endif %}
      <h1>{{ company_name or 'Company' }}</h1>
      <small>VAT: {{ tax_number or '-' }}{% if address %} | {{ address }}{% endif %}</small>
    </div>
    <div class="acct-print-report-title">
      <h2>{{ _('Expenses Report') }}</h2>
      <small>تقرير المصروفات</small>
    </div>
  </div>

  <div class="acct-print-meta">
    <span>{{ _('Printed') }}: {{ generated_at or '' }}</span>
    <span>{{ _('Range') }}: {{ start_date.strftime('%Y-%m-%d') if start_date else '—' }} → {{ end_date.strftime('%Y-%m-%d') if end_date else '—' }}</span>
    <span>{{ _('Branch') }}: {{ branch_label or _('All') }}</span>
  </div>

  <table class="acct-print-table">
    <thead>
      <tr>
        <th>{{ _('Date') }}</th>
        <th>{{ _('Invoice No.') }}</th>
        <th>{{ _('Description') }}</th>
        <th>{{ _('Payment method') }}</th>
        <th>{{ _('Total') }}</th>
      </tr>
    </thead>
    <tbody>
      {% for r in (data.rows or []) %}
      <tr>
        <td>{{ r.date }}</td>
        <td>{{ r.invoice_number }}</td>
        <td class="account">{{ r.description or '—' }}</td>
        <td>{% set pm = (r.payment_method or '')|upper %}{% if pm == 'CASH' %}{{ _('Cash') }}{% elif pm == 'BANK' %}{{ _('Bank') }}{% elif pm == 'INTERNAL' %}{{ _('Internal') }}{% else %}{{ r.payment_method or '—' }}{% endif %}</td>
        <td class="mono">{{ '{:,.2f}'.format(r.total or 0) }}</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <td colspan="4" class="account">{{ _('Total') }}</td>
        <td class="mono">{{ '{:,.2f}'.format(data.total or 0) }}</td>
      </tr>
    </tfoot>
  </table>

  <div class="acct-print-footer">
    {{ _('Generated by Accounting System') }}
  </div>

  <div class="acct-print-signature">
    <div class="sig-block"><span>{{ _('Accountant') }}</span><div class="sig-line"></div></div>
    <div class="sig-block"><span>{{ _('Stamp') }}</span><div class="sig-line"></div></div>
  </div>
  <div class="acct-print-pageno acct-print-footer">{{ _('Page') }} 1</div>

</body>
</html>

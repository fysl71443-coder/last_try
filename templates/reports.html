{% extends 'base.html' %}
{% block title %}{{ _('Reports') }}{% endblock %}
{% block content %}
<div class="container py-4 ops-layout hub-wrap">
  <div class="ops-header-bar mb-4">
    <span class="ops-icon"><i class="fa-solid fa-chart-line"></i></span>
    <div>
      <h1 class="ops-title mb-0">{{ _('Reports') }}</h1>
      <span class="ops-subtitle">{{ _('View and print sales, expenses, purchases, payroll and financial reports') }}</span>
    </div>
    <div class="ops-actions">
      <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('main.dashboard') }}"><i class="fa-solid fa-house me-1"></i>{{ _('Home') }}</a>
    </div>
  </div>

  <div id="reports-cards-view" class="reports-cards-view">
  <div class="row g-3">
    <div class="col-md-6 col-lg-4">
      <div class="card h-100 border-primary shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa-solid fa-coins text-primary me-2"></i>{{ _('Sales Report') }}</h5>
          <p class="card-text small text-muted">{{ _('View and print sales report by period and branch.') }}</p>
          <a href="{{ url_for('reports.reports_sales') }}" class="btn btn-primary btn-sm"><i class="fa-solid fa-eye me-1"></i>{{ _('View') }}</a>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa-solid fa-file-invoice-dollar me-2"></i>{{ _('Expenses Report') }}</h5>
          <p class="card-text small text-muted">{{ _('Expenses report with filters for accounts to include in print.') }}</p>
          <a href="{{ url_for('reports.reports_expenses') }}" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-eye me-1"></i>{{ _('View') }}</a>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa-solid fa-shopping-cart me-2"></i>{{ _('Purchases Report') }}</h5>
          <p class="card-text small text-muted">{{ _('Detailed purchase invoices and suppliers data.') }}</p>
          <a href="{{ url_for('reports.reports_purchases') }}" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-eye me-1"></i>{{ _('View') }}</a>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa-solid fa-chart-column me-2"></i>{{ _('Branch Sales by Day') }}</h5>
          <p class="card-text small text-muted">{{ _('Daily sales by branch and month with print option.') }}</p>
          <a href="{{ url_for('reports.reports_branch_sales') }}" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-eye me-1"></i>{{ _('View') }}</a>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa-solid fa-users me-2"></i>{{ _('Employees Report') }}</h5>
          <p class="card-text small text-muted">{{ _('Paid and due amounts, months due, and totals.') }}</p>
          <a href="{{ url_for('reports.reports_print_salaries_detailed') }}" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-eye me-1"></i>{{ _('View') }}</a>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa-solid fa-scale-balanced me-2"></i>{{ _('Trial Balance') }}</h5>
          <p class="card-text small text-muted">{{ _('Trial balance as of a given date.') }}</p>
          <a href="{{ url_for('financials.trial_balance') }}" class="btn btn-outline-primary btn-sm btn-report-embed" data-report-url="{{ url_for('financials.trial_balance') }}"><i class="fa-solid fa-eye me-1"></i>{{ _('View') }}</a>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa-solid fa-water me-2"></i>{{ _('Cash Flow') }}</h5>
          <p class="card-text small text-muted">{{ _('Cash flow report for the period.') }}</p>
          <a href="{{ url_for('financials.cash_flow') }}" class="btn btn-outline-primary btn-sm btn-report-embed" data-report-url="{{ url_for('financials.cash_flow') }}"><i class="fa-solid fa-eye me-1"></i>{{ _('View') }}</a>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa-solid fa-building-columns me-2"></i>{{ _('Balance Sheet') }}</h5>
          <p class="card-text small text-muted">{{ _('Statement of financial position as of date.') }}</p>
          <a href="{{ url_for('financials.balance_sheet') }}" class="btn btn-outline-primary btn-sm btn-report-embed" data-report-url="{{ url_for('financials.balance_sheet') }}"><i class="fa-solid fa-eye me-1"></i>{{ _('View') }}</a>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa-solid fa-chart-line me-2"></i>{{ _('Income Statement') }}</h5>
          <p class="card-text small text-muted">{{ _('Income statement for the period.') }}</p>
          <a href="{{ url_for('financials.income_statement') }}" class="btn btn-outline-primary btn-sm btn-report-embed" data-report-url="{{ url_for('financials.income_statement') }}"><i class="fa-solid fa-eye me-1"></i>{{ _('View') }}</a>
        </div>
      </div>
    </div>
  </div>
  </div>

  <div id="reports-embed-view" class="reports-embed-view" style="display: none;">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h5 class="mb-0">{{ _('Financial Report') }}</h5>
      <button type="button" class="btn btn-outline-secondary btn-sm" id="reports-embed-back"><i class="fa-solid fa-arrow-right me-1"></i>{{ _('Back to cards') }}</button>
    </div>
    <iframe id="reports-embed-iframe" src="" style="width:100%; min-height: 75vh; border: 1px solid #dee2e6; border-radius: 8px;" title="{{ _('Financial Report') }}"></iframe>
  </div>

</div>
{% endblock %}
{% block scripts %}
<script>
(function() {
  var cardsView = document.getElementById('reports-cards-view');
  var embedView = document.getElementById('reports-embed-view');
  var iframe = document.getElementById('reports-embed-iframe');
  var backBtn = document.getElementById('reports-embed-back');

  document.querySelectorAll('.btn-report-embed').forEach(function(a) {
    a.addEventListener('click', function(e) {
      e.preventDefault();
      var url = a.getAttribute('data-report-url');
      if (!url) return;
      iframe.src = url;
      if (cardsView) cardsView.style.display = 'none';
      if (embedView) embedView.style.display = 'block';
    });
  });

  if (backBtn && cardsView && embedView) {
    backBtn.addEventListener('click', function() {
      iframe.src = 'about:blank';
      embedView.style.display = 'none';
      cardsView.style.display = 'block';
    });
  }
})();
</script>
{% endblock %}

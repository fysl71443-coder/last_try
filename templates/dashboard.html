{% extends 'base.html' %}
{% block title %}{{ _('Dashboard / Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…') }}{% endblock %}
{% block content %}

<style>
:root{ --brand-brown:#8b5e3c; --brand-brown-dark:#6f482e; --card-bg:#ffffff; --card-border:rgba(0,0,0,.08); --glow-color:rgba(255,255,255,.75); --card-height:calc(clamp(110px, 13vw, 150px)); --icon-size:calc(clamp(28px, 3.4vw, 44px)) }
.bg-image{ position:fixed; inset:0; z-index:-2; background-image:url('{{ url_for('static', filename='images/logo.png') }}'); background-size:cover; background-position:center; filter:saturate(115%) contrast(105%); transform:scale(1.02) }
.bg-overlay{ position:fixed; inset:0; z-index:-1; background:linear-gradient(160deg, rgba(247,251,255,.7) 0%, rgba(238,243,249,.7) 50%, rgba(231,237,246,.7) 100%) }
.dashboard-panel{ background:#fff; border-radius:20px; box-shadow:0 20px 60px rgba(18,22,33,.08); padding:24px; max-width:100%; margin:0 auto; min-height:92vh; height:100% }
.dashboard-side{ background:#fff; border:1px solid rgba(0,0,0,.06); border-radius:16px; box-shadow:0 6px 16px rgba(18,22,33,.06); padding:12px }
.dashboard-side .side-item{ display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px; color:#2a2a2a; text-decoration:none; transition:background .2s ease, transform .2s ease }
.dashboard-side .side-item:hover{ background:#f7f7f9; transform:translateX(2px) }
.dashboard-side .side-icon{ width:26px; height:26px; display:inline-flex; align-items:center; justify-content:center; border-radius:10px; background:#eef2f7; color:#356; font-size:16px }
.stats-row{ display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:10px; margin-bottom:14px }
.stat-card{ background:#fff; border:1px solid rgba(0,0,0,.06); border-radius:16px; box-shadow:0 8px 20px rgba(18,22,33,.06); padding:14px; display:flex; align-items:center; gap:12px; min-height:64px }
.stat-card .stat-icon{ width:36px; height:36px; border-radius:12px; background:linear-gradient(180deg,#4caf50,#2e7d32); color:#fff; display:flex; align-items:center; justify-content:center; filter:drop-shadow(0 6px 12px rgba(0,0,0,.18)) }
.stat-card.orange .stat-icon{ background:linear-gradient(180deg,#ff9800,#f57c00) }
.stat-card.purple .stat-icon{ background:linear-gradient(180deg,#7e57c2,#5e35b1) }
.stat-card .stat-text{ line-height:1.1 }
.stat-card .value{ font-weight:800; font-size:1.1rem }
.stat-card .label{ font-size:.8rem; opacity:.7 }
.autumn-scene{ position:fixed; inset:0; pointer-events:none; z-index:0 }
.autumn-scene .shape{ position:absolute; opacity:.22; filter:blur(1px); animation:float 12s linear infinite, drift 14s ease-in-out infinite }
.autumn-scene .shape.square{ width:22px; height:22px; background:#8b5e3c; border-radius:6px }
.autumn-scene .shape.circle{ width:16px; height:16px; background:#f2a65a; border-radius:50% }
@keyframes float{ 0%{ transform:translateY(0) rotate(0deg) } 50%{ transform:translateY(-18px) rotate(6deg) } 100%{ transform:translateY(0) rotate(0deg) } }
@keyframes drift{ 0%{ transform:translateX(0) } 50%{ transform:translateX(24px) } 100%{ transform:translateX(0) } }
.card-link{ text-decoration:none; display:block }
.dashboard-card{ position:relative; border-radius:18px; padding:12px; text-align:center; overflow:hidden; box-shadow:0 10px 24px rgba(0,0,0,.10), 0 2px 8px rgba(0,0,0,.06); background:var(--card-bg); border:1px solid var(--card-border); transform:translateY(10px) scale(.98); opacity:0; will-change:transform,opacity; transition:transform .25s ease, opacity .25s ease, box-shadow .25s ease; display:flex; align-items:center; justify-content:center; flex-direction:column; height:var(--card-height); perspective:800px; transform-style:preserve-3d }
.dashboard-card.reveal{ transform:translateY(0) scale(1); opacity:1 }
.dashboard-card .title{ font-weight:700; margin:8px 0 0 0 }
.icon-3d{ width:var(--icon-size); height:var(--icon-size); margin:0 auto .3rem; display:block; filter:drop-shadow(0 10px 20px rgba(0,0,0,.18)) drop-shadow(0 0 18px var(--glow-color)); animation:pulseGlow 6s ease-in-out infinite; will-change:transform,filter; shape-rendering:geometricPrecision }
.dashboard-card:hover{ box-shadow:0 16px 32px rgba(0,0,0,.16) }
.dashboard-card:hover .icon-3d{ transform:translateZ(18px) scale(1.06) }
.dashboard-card::after{ content:""; position:absolute; inset:-40% -40% auto auto; height:120px; width:120px; background:radial-gradient(closest-side, rgba(255,255,255,.6), rgba(255,255,255,0)); transform:translate(0,0) rotate(25deg); opacity:0; transition:opacity .25s ease }
.dashboard-card:hover::after{ opacity:.7 }
.kind-sales,.kind-purchases,.kind-expenses,.kind-inventory,.kind-salaries,.kind-payments,.kind-reports,.kind-archive,.kind-vat,.kind-financials,.kind-journal,.kind-customers,.kind-menu,.kind-settings,.kind-users,.kind-tables,.kind-suppliers,.kind-empuvd{ background:#fff; border-color:var(--card-border) }
.dashboard-card .gate{ position:absolute; inset:0; display:flex; pointer-events:none }
.dashboard-card .gate .left,.dashboard-card .gate .right{ flex:1; background:linear-gradient(180deg, rgba(0,0,0,.08), rgba(0,0,0,.02)); backdrop-filter:saturate(120%) blur(.6px); transition:transform .45s cubic-bezier(.2,.8,.2,1) }
.dashboard-card .gate .left{ border-right:1px solid rgba(0,0,0,.06) }
.dashboard-card .gate .right{ border-left:1px solid rgba(0,0,0,.06) }
.dashboard-card.open .gate .left{ transform:translateX(-120%) }
.dashboard-card.open .gate .right{ transform:translateX(120%) }
.dashboard-card .flash{ position:absolute; inset:0; background:radial-gradient(closest-side, rgba(255,255,255,.0), rgba(255,255,255,.0)); pointer-events:none; opacity:0 }
.dashboard-card.open .flash{ animation:flash 520ms ease-out forwards }
@keyframes flash{ 0%{ opacity:0; background:radial-gradient(closest-side, rgba(255,255,255,.0), rgba(255,255,255,.0)) } 15%{ opacity:.9; background:radial-gradient(closest-side, rgba(255,255,255,.85), rgba(255,255,255,.0)) } 100%{ opacity:0 } }
.dashboard-card:hover{ transform:translateY(-2px); box-shadow:0 10px 20px rgba(0,0,0,.12) }
@media (prefers-reduced-motion: reduce){
  .autumn-scene .shape{ animation:none }
  .dashboard-card{ transition:none }
  .dashboard-card:hover{ transform:none }
}
/* Layout tuning: sidebar outside cards at far right */
.layout-row{ display:grid; grid-template-columns: 320px minmax(0,1fr); gap:16px; align-items:stretch; min-height:92vh }
.sidebar-col{ width:320px }
.content-col{ min-width:0 }
@media (max-width: 768px){ .layout-row{ grid-template-columns: 240px minmax(0,1fr) } }
.dashboard-side{ position:sticky; top:12px }
</style>

<div class="bg-image"></div>
<div class="bg-overlay"></div>
<div class="autumn-scene">
  <div class="shape square" style="left:18%; top:22%"></div>
  <div class="shape circle" style="left:34%; top:38%"></div>
  <div class="shape square" style="left:56%; top:26%"></div>
  <div class="shape circle" style="left:72%; top:52%"></div>
</div>
<div class="container-fluid py-4">
  <div class="row layout-row mb-3">
    <div class="col-md-3 sidebar-col">
      <div class="dashboard-side">
          <div class="d-flex align-items-center gap-2 mb-2"><div class="side-icon">ğŸ </div><strong>{{ _('Dashboard / Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…') }}</strong></div>
          {% if can('sales','view') %}<a class="side-item" href="{{ url_for('main.sales') }}"><div class="side-icon">ğŸ’°</div><span>{{ _('Sales / Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª') }}</span></a>{% endif %}
          {% if can('purchases','view') %}<a class="side-item" href="{{ url_for('main.purchases') }}"><div class="side-icon">ğŸ›’</div><span>{{ _('Purchases / Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª') }}</span></a>{% endif %}
          {% if can('suppliers','view') %}<a class="side-item" href="{{ url_for('main.suppliers') }}"><div class="side-icon">ğŸ¤</div><span>{{ _('Suppliers / Ø§Ù„Ù…ÙˆØ±Ø¯ÙˆÙ†') }}</span></a>{% endif %}
          {% if can('reports','view') %}<a class="side-item" href="{{ url_for('main.reports') }}"><div class="side-icon">ğŸ“Š</div><span>{{ _('Reports / Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±') }}</span></a>{% endif %}
          {% if can('archive','view') %}<a class="side-item" href="{{ url_for('main.archive') }}"><div class="side-icon">ğŸ—‚ï¸</div><span>{{ _('Archive / Ø§Ù„Ø£Ø±Ø´ÙŠÙ') }}</span></a>{% endif %}
          {% if can('financials','view') %}<a class="side-item" href="{{ url_for('financials.income_statement') }}"><div class="side-icon">ğŸ“˜</div><span>{{ _('Financial Statements / Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©') }}</span></a>{% endif %}
          {% if can('inventory','view') %}<a class="side-item" href="{{ url_for('main.inventory') }}"><div class="side-icon">ğŸ“¦</div><span>{{ _('Inventory / Ø§Ù„Ù…Ø®Ø²ÙˆÙ†') }}</span></a>{% endif %}
          {% if can('expenses','view') %}<a class="side-item" href="{{ url_for('main.expenses') }}"><div class="side-icon">ğŸ§¾</div><span>{{ _('Expenses / Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª') }}</span></a>{% endif %}
          
          {% if can('payments','view') %}<a class="side-item" href="{{ url_for('main.payments') }}"><div class="side-icon">ğŸ’³</div><span>{{ _('Payments / Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª') }}</span></a>{% endif %}
          {% if can('invoices','view') %}<a class="side-item" href="{{ url_for('main.invoices') }}"><div class="side-icon">ğŸ§¾</div><span>{{ _('Invoices / Ø§Ù„ÙÙˆØ§ØªÙŠØ±') }}</span></a>{% endif %}
          {% if can('customers','view') %}<a class="side-item" href="{{ url_for('main.customers') }}"><div class="side-icon">ğŸ§‘â€ğŸ¤â€ğŸ§‘</div><span>{{ _('Customers / Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡') }}</span></a>{% endif %}
          {% if can('menu','view') %}<a class="side-item" href="{{ url_for('main.menu') }}"><div class="side-icon">ğŸ½ï¸</div><span>{{ _('Menu / Ø§Ù„Ù…Ù†ÙŠÙˆ') }}</span></a>{% endif %}
          {% if can('settings','view') %}<a class="side-item" href="{{ url_for('main.settings') }}"><div class="side-icon">âš™ï¸</div><span>{{ _('Settings / Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª') }}</span></a>{% endif %}
          {% if can('table_settings','view') %}<a class="side-item" href="{{ url_for('main.table_settings') }}"><div class="side-icon">ğŸª‘</div><span>{{ _('Table Settings / Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø·Ø§ÙˆÙ„Ø§Øª') }}</span></a>{% endif %}
          {% if can('users','view') %}<a class="side-item" href="{{ url_for('main.users') }}"><div class="side-icon">ğŸ‘¤</div><span>{{ _('Users / Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†') }}</span></a>{% endif %}
          {% if can('vat','view') %}<a class="side-item" href="{{ url_for('vat.vat_dashboard') }}"><div class="side-icon">ğŸ§®</div><span>{{ _('VAT / Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©') }}</span></a>{% endif %}
          {% if can('journal','view') %}<a class="side-item" href="{{ url_for('journal.list_entries') }}"><div class="side-icon">ğŸ““</div><span>{{ _('Journal / Ø§Ù„ÙŠÙˆÙ…ÙŠØ©') }}</span></a>{% endif %}
          <a class="side-item" href="{{ url_for('main.employee_uvd') }}"><div class="side-icon">ğŸ‘¤</div><span>{{ _('Employee Dashboard / Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†') }}</span></a>
          {% if can('salaries','view') %}<a class="side-item" href="{{ url_for('main.advances_page') }}"><div class="side-icon">ğŸ’°</div><span>{{ _('Advances / Ø§Ù„Ø³Ù„Ù') }}</span></a>{% endif %}
        </div>
      </div>
    <div class="col-md-9 content-col">
      <div class="dashboard-panel">
        <div class="section-header mb-3">
          <h3 class="mb-0">{{ _('Dashboard / Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…') }}</h3>
        </div>
        <div class="stats-row">
          <div class="stat-card">
            <div class="stat-icon">ğŸ“ˆ</div>
          <div class="stat-text"><div class="value">{{ '%.2f'|format((stats.total_earnings or 0.0)) }} {{ _('Ø±ÙŠØ§Ù„') }}</div><div class="label">{{ _('Total Earnings') }}</div></div>
          </div>
          <div class="stat-card orange">
            <div class="stat-icon">ğŸ’³</div>
          <div class="stat-text"><div class="value">{{ '%.2f'|format((stats.avg_order_value or 0.0)) }} {{ _('Ø±ÙŠØ§Ù„') }}</div><div class="label">{{ _('Average Order Value') }}</div></div>
          </div>
          <div class="stat-card purple">
            <div class="stat-icon">âœ…</div>
            <div class="stat-text"><div class="value">{{ stats.orders_count or 0 }}</div><div class="label">{{ _('Orders') }}</div></div>
          </div>
        </div>

        <div class="row g-3 mt-2">
    {% if can('sales','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.sales') }}" class="card-link">
        <div class="dashboard-card kind-sales" data-target="{{ url_for('main.sales') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gCoin" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#ffd77a"/><stop offset="100%" stop-color="#ff9a3c"/></linearGradient></defs><circle cx="32" cy="32" r="22" fill="url(#gCoin)"/><circle cx="32" cy="32" r="18" fill="#fff3"/><path d="M26 36c0 4 12 4 12 0s-12-4-12 0z" fill="#fff8"/></svg>
          <div class="title">{{ _('Sales / Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª') }}</div>
          <div class="gate"><div class="left"></div><div class="right"></div></div>
          <div class="flash"></div>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('purchases','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.purchases') }}" class="card-link">
        <div class="dashboard-card kind-purchases" data-target="{{ url_for('main.purchases') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gCart" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#ffb3b3"/><stop offset="100%" stop-color="#ff6b6b"/></linearGradient></defs><rect x="16" y="22" width="32" height="18" rx="4" fill="url(#gCart)"/><circle cx="24" cy="44" r="4" fill="#333"/><circle cx="40" cy="44" r="4" fill="#333"/></svg>
          <div class="title">{{ _('Purchases / Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª') }}</div>
          <div class="gate"><div class="left"></div><div class="right"></div></div>
          <div class="flash"></div>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('suppliers','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.suppliers') }}" class="card-link">
        <div class="dashboard-card kind-suppliers" data-target="{{ url_for('main.suppliers') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gHandshake" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#b2ebf2"/><stop offset="100%" stop-color="#00bcd4"/></linearGradient></defs><path d="M22 32l10 6 10-6" fill="none" stroke="url(#gHandshake)" stroke-width="6" stroke-linecap="round"/></svg>
          <h6>{{ _('Suppliers / Ø§Ù„Ù…ÙˆØ±Ø¯ÙˆÙ†') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}


    {% if can('expenses','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.expenses') }}" class="card-link">
        <div class="dashboard-card kind-expenses" data-target="{{ url_for('main.expenses') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gExpense" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#ffccbc"/><stop offset="100%" stop-color="#ff7043"/></linearGradient></defs><rect x="18" y="20" width="28" height="24" rx="6" fill="url(#gExpense)"/><circle cx="32" cy="32" r="6" fill="#fff8"/></svg>
          <h6>{{ _('Expenses / Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('invoices','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.invoices') }}" class="card-link">
        <div class="dashboard-card kind-reports" data-target="{{ url_for('main.invoices') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gDoc" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#d1c4e9"/><stop offset="100%" stop-color="#9575cd"/></linearGradient></defs><rect x="18" y="14" width="28" height="36" rx="6" fill="url(#gDoc)"/><rect x="24" y="22" width="16" height="4" rx="2" fill="#fff9"/><rect x="24" y="30" width="16" height="4" rx="2" fill="#fff6"/></svg>
          <h6>{{ _('All Invoices / ÙƒÙ„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('inventory','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.inventory') }}" class="card-link">
        <div class="dashboard-card kind-inventory" data-target="{{ url_for('main.inventory') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gBox" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#b2dfdb"/><stop offset="100%" stop-color="#26a69a"/></linearGradient></defs><path d="M16 24l16-10 16 10v20l-16 10-16-10z" fill="url(#gBox)"/></svg>
          <h6>{{ _('Inventory & Costs / Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙˆØ§Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    

    {% if can('payments','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.payments') }}" class="card-link">
        <div class="dashboard-card kind-payments" data-target="{{ url_for('main.payments') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gCard" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#c5e1a5"/><stop offset="100%" stop-color="#8bc34a"/></linearGradient></defs><rect x="14" y="20" width="36" height="24" rx="6" fill="url(#gCard)"/><rect x="18" y="26" width="20" height="4" rx="2" fill="#fff9"/></svg>
          <h6>{{ _('Payments & Receivables / Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª ÙˆØ§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    

    
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.employee_uvd') }}" class="card-link">
        <div class="dashboard-card kind-empuvd" data-target="{{ url_for('main.employee_uvd') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="gEmp" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#bbdefb"/>
                <stop offset="100%" stop-color="#42a5f5"/>
              </linearGradient>
              <linearGradient id="gBadge" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#ffe082"/>
                <stop offset="100%" stop-color="#ffca28"/>
              </linearGradient>
            </defs>
            <rect x="10" y="12" width="44" height="36" rx="10" fill="url(#gEmp)"/>
            <circle cx="24" cy="30" r="8" fill="#fff6"/>
            <circle cx="40" cy="30" r="8" fill="#fff6"/>
            <rect x="18" y="40" width="28" height="6" rx="3" fill="#fff8"/>
            <circle cx="50" cy="16" r="7" fill="url(#gBadge)"/>
          </svg>
          <h6>{{ _('Employee Dashboard / Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†') }}</h6>
          <div class="gate"><div class="left"></div><div class="right"></div></div>
          <div class="flash"></div>
        </div>
      </a>
    </div>
    

    {% if can('reports','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.reports') }}" class="card-link">
        <div class="dashboard-card kind-reports" data-target="{{ url_for('main.reports') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gChart" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#d1c4e9"/><stop offset="100%" stop-color="#7e57c2"/></linearGradient></defs><rect x="20" y="30" width="6" height="14" rx="2" fill="url(#gChart)"/><rect x="30" y="24" width="6" height="20" rx="2" fill="url(#gChart)"/><rect x="40" y="34" width="6" height="10" rx="2" fill="url(#gChart)"/></svg>
          <h6>{{ _('Reports / Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('archive','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('main.archive') }}" class="card-link">
        <div class="dashboard-card kind-archive" data-target="{{ url_for('main.archive') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gFolder" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#cfd8dc"/><stop offset="100%" stop-color="#90a4ae"/></linearGradient></defs><path d="M14 24h16l4 6h16v20H14z" fill="url(#gFolder)"/></svg>
          <h6>{{ _('Archive / Ø§Ù„Ø£Ø±Ø´ÙŠÙ') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('vat','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('vat.vat_dashboard') }}" class="card-link">
        <div class="dashboard-card kind-vat" data-target="{{ url_for('vat.vat_dashboard') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gVat" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#ffe082"/><stop offset="100%" stop-color="#ffca28"/></linearGradient></defs><circle cx="32" cy="24" r="10" fill="url(#gVat)"/><rect x="20" y="36" width="24" height="10" rx="5" fill="#fff6"/></svg>
          <h6>{{ _('VAT / Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('financials','view') %}
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
      <a href="{{ url_for('financials.income_statement') }}" class="card-link">
        <div class="dashboard-card kind-financials" data-target="{{ url_for('financials.income_statement') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gBook" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#b3e5fc"/><stop offset="100%" stop-color="#03a9f4"/></linearGradient></defs><rect x="18" y="16" width="30" height="32" rx="6" fill="url(#gBook)"/><rect x="24" y="22" width="18" height="2" rx="1" fill="#fff9"/></svg>
          <h6>{{ _('Financial Statements / Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('journal','view') %}
    <div class="col-md-3 col-sm-6">
      <a href="{{ url_for('journal.list_entries') }}" class="card-link">
        <div class="dashboard-card kind-journal" data-target="{{ url_for('journal.list_entries') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gJournal" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#c8e6c9"/><stop offset="100%" stop-color="#66bb6a"/></linearGradient></defs><rect x="20" y="16" width="28" height="32" rx="6" fill="url(#gJournal)"/><circle cx="28" cy="32" r="3" fill="#fff9"/><circle cx="40" cy="32" r="3" fill="#fff9"/></svg>
          <h6>{{ _('Journal Entries / Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('customers','view') %}
    <div class="col-md-3 col-sm-6">
      <a href="{{ url_for('main.customers') }}" class="card-link">
        <div class="dashboard-card kind-customers" data-target="{{ url_for('main.customers') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gCust" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f8bbd0"/><stop offset="100%" stop-color="#ec407a"/></linearGradient></defs><circle cx="24" cy="26" r="7" fill="url(#gCust)"/><circle cx="40" cy="26" r="7" fill="url(#gCust)"/><rect x="18" y="36" width="28" height="10" rx="5" fill="#fff6"/></svg>
          <h6>{{ _('Customers / Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('menu','view') %}
    <div class="col-md-3 col-sm-6">
      <a href="{{ url_for('main.menu') }}" class="card-link">
        <div class="dashboard-card kind-menu" data-target="{{ url_for('main.menu') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gMenu" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#fff59d"/><stop offset="100%" stop-color="#fbc02d"/></linearGradient></defs><path d="M20 18h24v28H20z" fill="url(#gMenu)"/><rect x="24" y="24" width="16" height="3" rx="1.5" fill="#fff9"/><rect x="24" y="30" width="16" height="3" rx="1.5" fill="#fff6"/></svg>
          <h6>{{ _('Menu / Ø§Ù„Ù…Ù†ÙŠÙˆ') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('settings','view') %}
    <div class="col-md-3 col-sm-6">
      <a href="{{ url_for('main.settings') }}" class="card-link">
        <div class="dashboard-card kind-settings" data-target="{{ url_for('main.settings') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gGear" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#b0bec5"/><stop offset="100%" stop-color="#607d8b"/></linearGradient></defs><circle cx="32" cy="32" r="8" fill="#fff6"/><path d="M32 16l4 6 6 4-6 4-4 6-4-6-6-4 6-4z" fill="url(#gGear)"/></svg>
          <h6>{{ _('Settings / Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª') }}</h6>
        </div>
      </a>
    </div>
    {% endif %}

    {% if can('table_settings','view') %}
    <div class="col-md-3 col-sm-6">
      <a href="{{ url_for('main.table_settings') }}" class="card-link">
        <div class="dashboard-card kind-tables" data-target="{{ url_for('main.table_settings') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gChair" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#aed581"/><stop offset="100%" stop-color="#7cb342"/></linearGradient></defs><rect x="20" y="24" width="24" height="8" rx="2" fill="url(#gChair)"/><rect x="24" y="32" width="16" height="12" rx="2" fill="#fff6"/></svg>
          <h6>{{ _('Table Settings / Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø§ÙˆÙ„Ø§Øª') }}</h6>
        </div>
      </a>
    {% endif %}
    </div>

    {% if can('users','view') %}
    <div class="col-md-3 col-sm-6">
      <a href="{{ url_for('main.users') }}" class="card-link">
        <div class="dashboard-card kind-users" data-target="{{ url_for('main.users') }}">
          <svg class="icon-3d" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gKey" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#b0c4de"/><stop offset="100%" stop-color="#5c6bc0"/></linearGradient></defs><circle cx="28" cy="28" r="8" fill="url(#gKey)"/><rect x="36" y="26" width="12" height="4" rx="2" fill="#fff9"/></svg>
          <h6>{{ _('Users & Permissions / Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª') }}</h6>
        </div>
      </a>
    {% endif %}
    </div>
  </div>

  {% if (current_user.role|default('')) == 'user' %}
  <div class="mt-4">
    <div class="alert alert-info">
      {{ _('Sales users only see sales. Use the top menu to access your branch sales tables.') }}
    </div>
  </div>
  {% endif %}
</div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function(){
  var v = document.getElementById('bgVideo');
  if(v){
    v.addEventListener('error', function(){ v.style.display='none'; });
    try{ v.play().catch(function(){ v.style.display='none'; }); }catch(e){}
    var s = v.querySelector('source');
    if(s){
      s.addEventListener('error', function(){ v.style.display='none'; });
      try{
        var u = s.src;
        if(u){ fetch(u, { method:'HEAD' }).then(function(r){ if(!r.ok) v.style.display='none'; }).catch(function(){ v.style.display='none'; }); }
      }catch(_){}
    }
  }
  var io = new IntersectionObserver(function(entries){
    entries.forEach(function(e){ if(e.isIntersecting){ e.target.classList.add('reveal'); io.unobserve(e.target); } });
  }, { threshold:.15 });
  document.querySelectorAll('.dashboard-card').forEach(function(card){ io.observe(card); });
  document.querySelectorAll('.dashboard-card').forEach(function(card){
    var link = card.closest('a.card-link');
    if(!link) return;
    link.addEventListener('click', function(ev){
      ev.preventDefault();
      var target = card.getAttribute('data-target') || link.getAttribute('href');
      card.classList.add('open');
      setTimeout(function(){ window.location.href = target; }, 420);
    }, { once:false });
  });
});
</script>

{% endblock %}
/* Layout width tuning: sidebar + content */
.layout-row{ display:flex; gap:12px }
.sidebar-col{ flex:0 0 36%; max-width:36% }
.content-col{ flex:0 0 64%; max-width:64% }
@media (max-width: 992px){ .layout-row{ flex-direction:column } .sidebar-col, .content-col{ flex:0 0 100%; max-width:100% } }

# قائمة التحقق من الترجمة (i18n) — للمطورين

## مصدر النصوص الموحد
- **الملفات**: `translations/ar/LC_MESSAGES/messages.po` و `translations/en/LC_MESSAGES/messages.po`
- **الأداة**: Flask-Babel (gettext). في القوالب الدالة `_()` متاحة تلقائياً؛ في بايثون استخدم `from flask_babel import gettext as _`.

---

## قواعد إلزامية

### ١. رسائل Flash
كل استدعاء `flash(...)` يجب أن يمرر نصاً مترجماً:
```python
from flask_babel import gettext as _
flash(_('تم الحفظ بنجاح'), 'success')
flash(_('الفترة المالية مغلقة لهذا التاريخ.'), 'danger')
```
**لا تكتب** نصوصاً ثابتة بالعربية أو الإنجليزية فقط داخل `flash(...)`.

### ٢. التلميحات (Tooltips)
في القوالب استخدم الترجمة في `title` أو `data-bs-title`:
```html
<button title="{{ _('حفظ التغييرات') }}">...</button>
<span data-bs-toggle="tooltip" title="{{ _('توضيح الحقل') }}">...</span>
```

### ٣. Placeholder
في حقول الإدخال:
```html
<input placeholder="{{ _('ابحث بالاسم أو الرقم...') }}">
```

### ٤. التسميات (Labels)
جميع `<label>` وعناوين النماذج والأقسام:
```html
<label>{{ _('التاريخ') }}</label>
<h2>{{ _('إضافة مصروف') }}</h2>
```

### ٥. عناوين الأعمدة في الجداول
رؤوس الجداول يجب أن تكون قابلة للترجمة:
```html
<th>{{ _('التاريخ') }}</th>
<th>{{ _('المبلغ') }}</th>
```

### ٦. أزرار الإجراءات
نص كل زر:
```html
<button>{{ _('حفظ') }}</button>
<button>{{ _('طباعة') }}</button>
<button>{{ _('إقفال السنة') }}</button>
```

---

## المطبوعات (PDF / HTML للطباعة)
- في **قوالب الطباعة** استخدم `get_locale()` لتعيين اللغة والاتجاه:
  - `lang="{{ get_locale() or 'ar' }}"` و `dir="{{ 'rtl' if (get_locale() or 'ar') == 'ar' else 'ltr' }}"`
- جميع العناوين والنصوص داخل قالب الطباعة يجب أن تمر عبر `{{ _('...') }}` حتى يعكس المطبوع اللغة المختارة.
- إذا تقرير معين **لا يدعم لغة** محددة، اعرض رسالة تنبيه للمستخدم (مثلاً: "هذا التقرير متوفر بالعربية فقط").

---

## إضافة ترجمات جديدة
1. أضف النص بالإنجليزية (أو العربي) كـ **msgid** في الكود أو القالب داخل `_('النص')`.
2. استخرج الرسائل: `pybabel extract -F babel.cfg -o messages.pot .`
3. حدّث ملفات .po: `pybabel update -i messages.pot -d translations`
4. أضف الترجمة في `translations/ar/LC_MESSAGES/messages.po` و `translations/en/LC_MESSAGES/messages.po` (حقل msgstr).
5. Compile: `pybabel compile -d translations` (أو السكربت الموجود في المشروع).

---

## الاختبار
- غيّر اللغة من الواجهة (رابط EN أو ع في الشريط العلوي).
- تحقق أن **كل** النصوص في الصفحة (بما فيها flash بعد إجراء) تتحول بدون قص أو تشوه.
- افتح صفحة طباعة (ميزان مراجعة، فاتورة، كشف حساب) وتأكد أن اللغة والاتجاه يطابقان اللغة المختارة.

---

## مرجع
- الفحص الشامل للواجهة والترجمة: **docs/I18N_AND_UI_AUDIT.md**
- جدول التقييم لكل شاشة: داخل نفس الملف (القسم ٧).
